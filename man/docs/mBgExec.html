<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Montage User Documentation</title>
<!--#include virtual="include/header.html"-->
<div id="wrapper">
<h1>mBgExec</h1>

<div id="usage">
<a name="usage"></a>

<dl class="description">
  <dt>Description:</dt>
  <dd>Runs mBackground on all the images in a metadata table, using the corrections generated by mFitExec.</dd>
</dl>

<dl class="syntax">
  <dt>Syntax:</dt>
  <dd>mBgExec [-p <i>projdir</i>] [-s <i>statusfile</i>] [-d] [-n(o-areas)] <b>images.tbl corrections.tbl corrdir</b></dd>
</dl>

<p class="dochead">Switches:</p>
<dl class="args">
  <dt>-p <i>projdir</i></dt>
  <dd>Specifies the path to the directory containing the projected images.</dd>
  <dt>-s <i>statusfile</i></dt>
  <dd>Writes output message to <i>statusfile</i> instead of to <tt>stdout</tt></dd>
  <dt>-d</dt>
  <dd>Turns on debugging</dd>
  <dt>-n</dt>
  <dd>Indicates that no area images are present (assumes equal weighting for each pixel)</dd>
</dl>

<p class="dochead">Arguments:</p>
<dl class="args">
  <dt>images.tbl</i></dt>
  <dd>Image metadata table generated by mImgtbl.</dd>
  <dt>corrections.tbl</dt>
  <dd>Table of corrections generated by mFitExec</dd>
  <dt>corrdir</dt>
  <dd>Directory where output images should be written</dd>
</dl>


<dl class="description">
  <dt>Results:</dt>
  <dd>Output FITS images will be created in the directory specified by <i>corrdir</i>, with names that are the same as the uncorrected images.</dd>
</dl>

<a name="ex"></a><p class="dochead">Examples:</p>

<p>In this example, <span class="file"><a href="examples/mBgExec/images.tbl">images.tbl</a></span> describes the unprojected or projected images (filenames are the same if <span class="file">mProjExec</span> was used), and <span class="file"><a href="examples/mBgExec/corrections.tbl">corrections.tbl</a></span> was generated using <span class="file">mBgModel</span> after running <span class="file">mDiffExec</span> and <span class="file">mFitExec</span> on those images.</p>

<dl class="example">
  <dt>$ mBgExec -p proj images.tbl corrections.tbl corr</dt>
  <dd>[struct stat="OK", count=16, failed=0]</dd>
</dl>

<p><tt>corr</tt> now contains the images with background removal applied.</p>

<p class="dochead">Return Codes:</p>
<ul class="returncodes">
  <li>[struct stat="OK", count=<i>num-images</i>, nocorrection=<i>num-skipped</i>, failed=<i>num-failed</i>]</li>    
  <li>[struct stat="ERROR", msg="Usage: mBgExec [-p projdir] [-s statusfile] [-d] [-n(o-areas)] images.tbl corrections.tbl corrdir"]</li>    
  <li>[struct stat="ERROR", msg="MPI initialization failed"]</li>    
  <li>[struct stat="ERROR", msg="Cannot open status file: <i>statusfile</i>"]</li>    
  <li>[struct stat="ERROR", msg="Cannot access <i>corrdir</i>"]</li>    
  <li>[struct stat="ERROR", msg="<i>corrdir</i> is not a directory"]</li>    
  <li>[struct stat="ERROR", msg="Invalid image metadata file: <i>images.tbl</i>"]</li>    
  <li>[struct stat="ERROR", msg="Need columns: cntr and fname in image list"]<span class="explanation">(columns missing from image metadata table)</span></li>    
  <li>[struct stat="ERROR", msg="Too many entries in image list for compiled program"]<span class="explanation>(Maximum number of files to perform background correction on has been exceeded - see MAXFILE declaration in mBgExec.c)</span></li>
  <li>[struct stat="ERROR", msg="Need columns: id,a,b,c in corrections file"]<span class="explanation">(columns missing from corrections table)</span></li>    
  <li>[struct stat="ERROR", msg="<i>mBackground error</i>"]</li>    
</ul>
</div>
</div>
<!--#include virtual="include/footer.html"-->
