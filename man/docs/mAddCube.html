<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	  <head>
  <title>Montage User Documentation</title>
<!--#include virtual="include/header.html"-->

<!-- BEGIN DOCUMENTATION TITLE -->
<div id="wrapper">

<h1>mAddCube</h1>

<div id="usage">
<dl class="description">
  <dt>Description:</dt>
  <dd>Coadd the reprojected cubes in an input list to form an output mosaic with FITS header keywords specified in a header file. Creates two output files, one containing the coadded pixel values for each cube plane, and the other containing coadded pixel area values. The pixel area values can be used as a weighting function if the output cube values are themselves to be coadded with other projected cubes, and may also be used in validating the fidelity of the output pixel values.</dd>
</dl>

<dl class="syntax">
  <dt>Syntax:</dt>
  <dd>mAddCube [-p <i>imgdir</i>] [-n(o-areas)] [-a mean|median|count] [-e(xact-size)] [-d <i>level</i>] [-s <i>statusfile</i>] <b>images.tbl template.hdr out.fits</b></dd>
</dl>

<p class="dochead">Switches:</p>
<dl class="args">
  <dt>-p <i>imgdir</i></dt>
  <dd>Specifies path to directory containing reprojected images.  If the -p switch is not included, mAddCube will look for the input images in the current working directory.</dd>

  <dt>-n</dt>
  <dd>Co-addition ignores weighting by pixel areas and performs coaddition based only on pixel postions. Will not output an area image for the output image.</dd>

  <dt>-a <i>type</i></dt>
  <dd>Select type of averaging to be done on accumulated pixel values (either <b>mean</b> or <b>median</b>).  To generate a map showing counts of how many times each pixel was overlapped by the input images, use <b>count</b>.

  <dt>-e </dt>
  <dd>Enables exact size mode. The output image will match the header template exactly, instead of shrinking the output to fit the data.</dd>

  <dt>-d <i>level</i></dt>
  <dd>Turns on debugging to the specified level (1-3).</dd>

  <dt>-s <i>statusfile</i></dt>
  <dd>mAddCube output and errors will be written to <i>statusfile</i> instead of stdout.</dd>
</dl>

<p class="dochead">Arguments:</p>
<dl class="args">
  <dt>images.tbl</dt>
  <dd>ASCII table (generated by mImgtbl) containing metadata for all images to be coadded.  For cubes, mImgtbl needs to be run with the -C option which picks up the third dimension parameters (and fourth if they exist).</dd>

  <dt>template.hdr</dt>
  <dd>FITS header template to be used in generation of output FITS cube.</dd>

  <dt>out.fits</dt>
  <dd>Name of output FITS image.</dd>
</dl>


<dl class="description">
<dt>Results:</dt>
  <dd>If successful, mAddCube creates a FITS datacube file <span class="file">out.fits</span> that is a coadd of all the FITS cubes in the table <span class="file">images.tbl</span>, according to the header template given.  A corresponding <span class="file">out_area.fits</span> is also created.</dd>

</dl>

<p class="dochead">Examples:</p>
<p>The following example runs <span class="file">mAddCube</span> on 4 FITS images, generating the output file <span class="file">mosaic.fits</span>.  Related files are <a href="examples/mAddCube/images.tbl">images.tbl</a> and <a href="examples/mAddCube/template.hdr">template.hdr</a>.</p>

<dl class="example">
  <dt>$ mAddCube -p proj images.tbl template.hdr output/mosaic.fits</dt>
  <dd>[struct stat="OK", time=1]</dd>
</dl>


<p class="dochead">Return Codes:</p>
<ul class="returncodes">
  <li>[struct stat = "OK", time=<i>time</i>]</li>
  <li>[struct stat="ERROR", msg="Usage: mAddCube [-p imgdir] [-n(o-areas)] [-a mean|median|count] [-e(xact-size)] [-d level] [-s statusfile] images.tbl template.hdr out.fits"]</li>
  <li>[struct stat="ERROR", msg="Invalid argument for -a flag"]</li>
  <li>[struct stat="ERROR", msg="Cannot open status file: <i>statusfile</i>"]</li>
  <li>[struct stat="ERROR", msg="Invalid image metadata file: <i>filename</i>"]</li>
  <li>[struct stat="ERROR", msg="Need columns: cntr,fname, crpix1, crpix2, cdelt1, cdelt2, naxis1, naxis2, crval1, crval2, naxis3 in image list"]</li>
  <li>[struct stat="ERROR", msg="Too many open files"]</li>
  <li>[struct stat="ERROR", msg="Input wcsinit() failed."]</li>
  <li>[struct stat="ERROR", msg="Bad WCS in header template."]</li>
  <li>[struct stat="ERROR", status=<i>stat</i>, msg="<i>FITS library error</i>"]</li>
  <li>[struct stat="ERROR", msg="<i>general error message</i>"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for file info (realloc)"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for file info structs"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for area file info structs"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for input buffer"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for input area buffer"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for start/end info"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for data line pointers"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for data line"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for area line pointers"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for area line"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for data counts"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for output data line"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for output area line"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for data line (realloc)"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for area line (realloc)"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for median array"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for median array (realloc)"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for linked list structs"]</li>
  <li>[struct stat="ERROR", msg="Allocation failed for linked list structs (additions)"]</li>

</div>

</div>
<!--#include virtual="include/footer.html"-->
