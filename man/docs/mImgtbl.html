<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	  <head>
	    <title>Montage User Documentation</title>
	    <!--#include virtual="include/header.html"-->
<div id="wrapper">
<h1>mImgtbl</h1>

<div id="usage">

<dl class="description">
  <dt>Description:</dt>
  <dd><span class="file">mImgtbl</span> extracts the FITS header geometry information from a set of files and creates an ASCII image metadata table which is used by several of the other programs.  It only collects data from headers that comply with the FITS standard, but reports a count of images that fail that check.</dd>
</dl>

<dl class="syntax">
  <dt>Syntax:</dt>
  <dd>mImgtbl [-rcadb] [-s <i>statusfile</i>] [-f <i>fieldlistfile</i>] [-t <i>imglist</i>] <b>directory images.tbl</b></dd>
</dl>

<p class="dochead">Switches:</p>
<dl class="args">
  <dt>-r</dt>
  <dd><span class="file">mImgtbl</span> can also be used as a standalone program to gather image metadata for other purposes (to populate a database, as a basis for spatial coverage searches, etc.)   In this case it is often desirable to collect information on all the files in a directory tree recursively.  The "-r" (recursive) flag instructs <span class="file">mImgtbl</span> to search the given directory and all its subdirectories recursively.</dd>
  <dt>-c</dt>
  <dd>The "-c" (corners) option in mImgtbl will cause eight extra columns to be added to the output metadata table containing the RA, Dec coordinates (ra1, dec1, ... ra4, dec4) of the image corners.  The output is always Equatorial J2000, even if the input is some other system.  Though not required for the core proessing modules, we recommend using this option, as some of the utilities may require corner locations to function properly.</dd>
  <dt>-C</dt>
  <dd>The original version of mImgtbl ignored cube structure in the files; it only looked at the first two dimensions and associated WCS parameters.  When cube processing was added to Montage, it was necessary to examine the third and fourth dimensions (if they exist) and so some additional columns were added to the mImgtbl output (<i>e.g.,</i> NAXIS4, CRVAL3).  It is still often the case where all of the new columns would be blank, so to save space the old mode output can be invoked using the "-C" (no-cube) option.  This is cosmetic for the most part, since the "four-dimensional" output is perfectly valid for further processing of 2D data.</dd> 
  <dt>-a</dt>
  <dd>By default, mImgtbl ignores FITS files with names ending in <span class="file">_area</span> (i.e. <span class="file">name_area.fits</span>), assuming them to be Montage-created area images.  If you want to generate information on these images, or if you have images with <span class="file">_area</span> in the title <i>other than</i> those generated by Montage, you should turn on this flag to force <span class="file">mImgtbl</span> to look at all images in the directory.</dd>
  <dt>-d</dt>
  <dd>Turn on debugging</dd>
  <dt>-b</dt>
  <dd>When this switch is set, <span class="file">mImgtbl</span> will explicitly output each FITS file it finds that does not appear to be valid, along with information on the error.</dd>
  <dt>-s <i>statusfile</i></dt>
  <dd>Output and errors are written to <i>statusfile</i> instead of being written to stdout.</dd>
  <dt>-f <i>fieldlistfile</i></dt>
  <dd>Used to specify a <i>fieldlist</i>, which will list additional keywords to be read from the FITS headers and included in the output table.  Fieldlists should specify the keyword name, type (int,char,double), and size. Example: <a href="examples/mImgtbl/example.fieldlist">example.fieldlist</a>.</dd>
  <dt>-t <i>imglist</i></dt>
  <dd><span class="file">mImgtbl</span> will only process files with names specified in table <i>imglist</i>, ignoring any other files in the directory. Example: <a href="examples/mImgtbl/example.imglist">example.imglist</a>.</dd>
</dl>

<p class="dochead">Arguments:</p>
<dl class="args">
  <dt>directory</dt>
  <dd>Path to directory containing set of input FITS files.</dt>
  <dt>images.tbl</dt>
  <dd>Path of output metadata table.</dd>
</dl>

<dl class="description">
  <dt>Results:</dt>
  <dd>Output table contains metadata information from all readable FITS files in the directory specified by <i>directory</i>.  <i>count</i> is the number of records in the table, and <i>badfits</i> is the number of files for which FITS metadata could not be extracted.</dd>
</dl>

<p class="dochead">Examples:</p>

<p>The following example runs <span class="file">mImgtbl</span> on a directory containing 14 2MASS images:</p>

<dl class="example">
  <dt>$ mImgtbl input/2mass images.tbl</dt>
  <dd>[struct stat="OK", count=14, badfits=0]</dd>
</dl>

<p>Output: <a href="examples/mImgtbl/images.tbl"><span class="file">images.tbl</span></a>.</p>

<p>Running <span class="file">mImgtbl</span> on a directory that contains 3 bad FITS images, with the -c switch on:</p>
<dl class="example">
  <dt>$ mImgtbl -c input/2mass-bad images-corners.tbl</dt>
  <dd>[struct stat="OK", count=14, badfits=3]</dt>
</dl>

<p>The output file is identical to the first example, but with the addition of 8 "corners" columns: <a href="examples/mImgtbl/images-corners.tbl"><span class="file">images-corners.tbl</span></a>.  The <span class="file">badfits</span> counter in the output message reports on how many images were found containing invalid header information.</p>

<p>When passed a field list file like this <a href="examples/mImgtbl/example.fieldlist">example</a>, extra columns are extracted from the FITS headers and inserted in the table:</p>

<dl class="example">
  <dt>$ mImgtbl -f example.fieldlist input/2mass images-expanded.tbl</dt>
  <dd>[struct stat="OK", count=14, badfits=0]</dd>
</dl>

<p>The output file has additional columns as specified: <a href="examples/mImgtbl/images-expanded.tbl"><span class="file">images-expanded.tbl</span></a>.</p>

<p class="dochead">Column Names:</p>
<dl class="args">
  <dt>cntr</dt>
  <dd>A unique counter (row number)</dd>
  <dt>ra,dec</dt>
  <dd>Image position in decimal degree format</dd>
  <dt>cra,cdec</dt>
  <dd>Right ascension in HHMMSS.SS format. Declination in DDMMSS.S format</dd>
  <dt>naxis1, naxis2</dt>
  <dd>The size of the image in pixels for dimensions 1 and 2</dd>
  <dt>ctype1, ctype2</dt>
  <dd>The coordinate system (the first four characters) and WCS map projection (last three characters) for dimensions 1 and 2</dd>
  <dt>crpix1, crpix2</dt>
  <dd>The pixel coordinates of the reference location (can be fractional and can be off the image) for dimensions 1 and 2</dd>
  <dt>crval1, crval2</dt>
  <dd>The coordinates of a reference location on the sky (often at the center of the image) for dimensions 1 and 2</dd>
  <dt>cdelt1, cdelt2</dt>
  <dd>The pixel scale (in degrees on the sky per pixel) at the reference location for dimensions 1 and 2</dd>
  <dt>crota2</dt>
  <dd>The rotation angle from the "up" direction to the celestial pole</dd>
  <dt>equinox</dt>
  <dd>Precessional year associated with the coordinate system</dd>
  <dt>hdu</dt>
  <dd>Numerical identifier for the FITS extension that the image info is extracted from, for FITS files with multiple HDUs.</dd>
  <dt>size</dt>
  <dd>Filesize (in bytes) of the input FITS file</dd>
  <dt>fname</dt>
  <dd>The path to the input FITS file</dd>
</dl>

<p class="dochead">Return Codes:</p>
<ul class="returncodes">
  <li>[struct stat="OK", count=<i>count</i>, badfits=<i>badfits</i>]</li>   
  <li>[struct stat="ERROR", msg="Usage: %s [-rcadb][-s statusfile][-f fieldlistfile][-t imglist] directory images.tbl"]</li>   
  <li>[struct stat="ERROR", msg="Illegal argument: -<i>arg</i>"]</li>   
  <li>[struct stat="ERROR", msg="Cannot open status file: <i>statusfile</i>"]</li>   
  <li>[struct stat="ERROR", msg="Cannot open field list file: <i>fieldlistfile</i>"]</li>   
  <li>[struct stat="ERROR", msg="Cannot open image list file: <i>imgfile</i>"]</li>   
  <li>[struct stat="ERROR", msg="Image table needs column fname/file"]</li>   
  <li>[struct stat="ERROR", msg="Illegal field name: <i>string</i>]</li>   
  <li>[struct stat="ERROR", msg="Illegal field type: <i>string</i>]</li>   
  <li>[struct stat="ERROR", msg="Cannot access <i>directory</i>"]</li>   
  <li>[struct stat="ERROR", msg="<i>directory</i> is not a directory"]</li>   
  <li>[struct stat="ERROR", msg="Can't open output table."]</li>   
  <li>[struct stat="ERROR", msg="Can't open copy table."]</li>   
  <li>[struct stat="ERROR", msg="Can't open tmp (in) table."]</li>   
  <li>[struct stat="ERROR", msg="Can't open tmp (out) table."]</li>   
  <li>[struct stat="ERROR", msg="Can't open final table."]</li>   
  <li>[struct stat="ERROR", flag=<i>n</i>, msg="<i>FITS library error</i>"]</li>   
</ul>

</div></div>
<!--#include virtual="include/footer.html"-->
