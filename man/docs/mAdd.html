<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	  <head>
  <title>Montage User Documentation</title>
<!--#include virtual="include/header.html"-->

<!-- BEGIN DOCUMENTATION TITLE -->
<div id="wrapper">

<h1>mAdd</h1>

<div id="usage">
<dl class="description">
  <dt>Description:</dt>
  <dd>Coadd the reprojected images in an input list to form an output mosaic with FITS header keywords specified in a header file. Creates two output files, one containing the coadded pixel values, and the other containing coadded pixel area values. The pixel area values can be used as a weighting function if the output pixel values are themselves to be coadded with other projected images, and may also be used in validating the fidelity of the output pixel values.</dd>
</dl>

<dl class="syntax">
  <dt>Syntax:</dt>
  <dd>mAdd [-p <i>imgdir</i>] [-n(o-areas)] [-a mean|median|count] [-e(xact-size)] [-d <i>level</i>] [-s <i>statusfile</i>] <b>images.tbl template.hdr out.fits</b></dd>
</dl>

<p class="dochead">Switches:</p>
<dl class="args">
  <dt>-p <i>imgdir</i></dt>
  <dd>Specifies path to directory containing reprojected images.  If the -p switch is not included, mAdd will look for the input images in the current working directory.</dd>

  <dt>-n</dt>
  <dd>Co-addition ignores weighting by pixel areas and performs coaddition based only on pixel postions.  This flag refers to <i>input</i> images; the area file for the output image will still be created.</dd>

  <dt>-a <i>type</i></dt>
  <dd>Select type of averaging to be done on accumulated pixel values (either <b>mean</b> or <b>median</b>).  To generate a map showing counts of how many times each pixel was overlapped by the input images, use <b>count</b>.

  <dt>-e </dt>
  <dd>Enables exact size mode. The output image will match the header template exactly, instead of shrinking the output to fit the data.</dd>

  <dt>-d <i>level</i></dt>
  <dd>Turns on debugging to the specified level (1-3).</dd>

  <dt>-s <i>statusfile</i></dt>
  <dd>mAdd output and errors will be written to <i>statusfile</i> instead of stdout.</dd>
</dl>

<p class="dochead">Arguments:</p>
<dl class="args">
  <dt>images.tbl</dt>
  <dd>ASCII table (generated by mImgtbl) containing metadata for all images to be coadded.</dd>

  <dt>template.hdr</dt>
  <dd>FITS header template to be used in generation of output FITS</dd>

  <dt>out.fits</dt>
  <dd>Name of output FITS image.</dd>
</dl>


<dl class="description">
<dt>Results:</dt>
  <dd>If successful, mAdd creates a FITS file <span class="file">out.fits</span> that is a coadd of all the FITS files in the table <span class="file">images.tbl</span>, according to the header template given.  A corresponding <span class="file">out_area.fits</span> is also created.</dd>

</dl>

<p class="dochead">Examples:</p>
<p>The following example runs <span class="file">mAdd</span> on 4 FITS images, generating the output file <span class="file">mosaic.fits</span>.  Related files are <a href="examples/mAdd/images.tbl">images.tbl</a> and <a href="examples/mAdd/template.hdr">template.hdr</a>.</p>

<dl class="example">
  <dt>$ mAdd -p proj images.tbl template.hdr output/mosaic.fits</dt>
  <dd>[struct stat="OK", time=1]</dd>
</dl>


<p class="dochead">Return Codes:</p>
<ul class="returncodes">
  <li>[struct stat = "OK", time=<i>time</i>]</li>
  <li>[struct stat="ERROR", msg="Usage: mAdd [-p imgdir] [-n(o-areas)] [-a mean|median|count] [-e(xact-size)] [-d level] [-s statusfile] images.tbl template.hdr out.fits"]</li>
  <li>[struct stat="ERROR", msg="MPI initialization failed"]</li>
  <li>[struct stat="ERROR", msg="Invalid argument for -a flag"]</li>
  <li>[struct stat="ERROR", msg="Cannot open status file: <i>statusfile</i>"]</li>
  <li>[struct stat="ERROR", msg="Invalid image metadata file: <i>filename</i>"]</li>
  <li>[struct stat="ERROR", msg="Need columns: cntr,fname, crpix1, crpix2, cdelt1, cdelt2, naxis1, naxis2, crval1, crval2 in image list"]<span class="explanation">(missing columns in image metadata table)</span></li>
  <li>[struct stat="ERROR", msg="Memory allocation failed"]</li>
  <li>[struct stat="ERROR", msg="Too many open files"]</li>
  <li>[struct stat="ERROR", msg="Input wcsinit() failed."]</li>
  <li>[struct stat="ERROR", msg="Failed to allocate enough memory for output arrays"]</li>
  <li>[struct stat="ERROR", msg="Bad WCS in header template."]</li>
  <li>[struct stat="ERROR", msg="Images are not in same pixel space."]</li>
  <li>[struct stat="ERROR", msg="Template file not found."]</li>
  <li>[struct stat="ERROR", status=<i>stat</i>, msg="<i>FITS library error</i>"]</li>
  <li>[struct stat="ERROR", msg="<i>general error message</i>"]</li>
</ul>

</div>

</div>
<!--#include virtual="include/footer.html"-->
