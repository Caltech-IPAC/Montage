<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Montage User Documentation</title>
  <!--#include virtual="include/header.html"-->
  <div id="wrapper">
<h1>mBgModel</h1>

<ul>
<li><a href="#usage">Usage</a></li>
<li><a href="#ex">Examples</a></li>
</ul>

<div id="usage">
<a name="usage"></a>

<dl class="description">
  <dt>Description:</dt>
  <dd><span class="file">mBgModel</span> is a modelling/fitting program.  It uses the image-to-image difference parameter table created by <span class="file">mFitExec</a> to interactively determine a set of corrections to apply to each image in order to achieve a "best" global fit.</dd>
</dl>

<dl class="syntax">
  <dt>Syntax:</dt>
  <dd>mBgModel [-i <i>niter</i>] [-l(evel-only)] [-d <i>level</i>] [-r <i>refimg</i>] [-s <i>statusfile</i>] <b>images.tbl fits.tbl corrections.tbl</b></dd>
</dl>

<p class="dochead">Switches:</p>
<dl class="args">
  <dt>-i <i>-niter</i></dt>
  <dd>Number of iterations (without switch, defaults to 5000). Can be between 1 and 32767.</dd>
  <dt>-l</dt>
  <dd>Calculate level adjustments only (ie, don't attempt to match the slopes)</dd>
  <dt>-d <i>level</i></dt>
  <dd>Turns on debugging to the specified level (1-3).</dd>
  <dt>-r <i>refimg</i></dt>
  <dd>Turns on additional debugging for the <i>n</i>th image in <span class="file">images.tbl</span>.</dd>
  <dt>-s <i>statusfile</i></dt>
  <dd><span class="file">mBgModel</span> output and errors are written to <i>statusfile</i> instead of to stdout.</dd>
</dl>

<p class="dochead">Arguments:</p>
<dl class="args">
  <dt>images.tbl</dt>
  <dd>Image metadata table generated by <span class="file">mImgtbl</span>.</dd>
  <dt>fits.tbl</dt>
  <dd>Plane fitting table generated by <span class="file">mFitExec</span>.</dd>
  <dt>corrections.tbl</dt>
  <dd>Output table of background corrections</dd>
</dl>

<p class="dochead">Return Codes:</p>
<ul class="returncodes">
  <li>[struct stat="OK"]</li>   
  <li>[struct stat="ERROR", msg="Usage: mBgModel [-i niter] [-l(evel-only)] [-d level] [-r refimg] [-s statusfile] images.tbl fits.tbl corrections.tbl"]</li>   
  <li>[struct stat="ERROR", msg="Argument for -i (<i>string</i>) cannot be interpreted as an integer"]</li>   
  <li>[struct stat="ERROR", msg="Number of iterations too small (<i>niter</i>). This parameter is normally around 5000."]</li>   
  <li>[struct stat="ERROR", msg="Argument for -r (<i>string</i>) cannot be interpreted as an integer"]</li>   
  <li>[struct stat="ERROR", msg="Cannot open status file: <i>statusfile</i>"]</li>   
  <li>[struct stat="ERROR", msg="Failed to open output <i>filename</i>"]</li>   
  <li>[struct stat="ERROR", msg="Invalid image metadata file: <i>filename</i>"]</li>   
  <li>[struct stat="ERROR", msg="Need columns: cntr nl ns crpix1 crpix2 in image info file"] <span class="explanation">(columns missing from image metadata table)</span></li>   
  <li>[struct stat="ERROR", msg="malloc() failed (ImgInfo)"] <span class="explanation">(Memory error)</span></li>   
  <li>[struct stat="ERROR", msg="realloc() failed (ImgInfo)"] <span class="explanation">(Memory error)</span></li>   
  <li>[struct stat="ERROR", msg="Invalid background fit parameters file: <i>filename</i>"]</li>   
  <li>[struct stat="ERROR", msg="Need columns: plus minus a b c crpix1 crpix2 xmin xmax ymin ymax xcenter ycenter npixel rms boxx boxy boxwidth boxheight boxang"]<span class="explanation"> (columns missing from background parameter table)</span></li>   
  <li>[struct stat="ERROR", msg="malloc() failed (FitInfo)"] <span class="explanation">(Memory error)</span></li>   
  <li>[struct stat="ERROR", msg="realloc() failed (FitInfo)"] <span class="explanation">(Memory error)</span></li>   
  <li>[struct stat="ERROR", msg="malloc() failed (CorrInfo)"] <span class="explanation">(Memory error)</span></li>   
  <li>[struct stat="ERROR", msg="realloc() failed (CorrInfo)"] <span class="explanation">(Memory error)</span></li>   
  <li>[struct stat="ERROR", msg="Debug reference image out of range (0 - <i>n</i>)"]</li>   
  <li>[struct stat="ERROR", msg="Invalid fit type"]</li>   
  <li>[struct stat="ERROR", msg="Allocation failure in ivector()"] <span class="explanation">(Memory error)</span></li>   
</ul>

<dl class="description">
  <dt>Results:</dt>
  <dd>Output table containing corrections to be applied to each image.</dd>
</dl>

<a name="ex"></a><p class="dochead">Examples:</p>

<p>After running <span class="file">mDiffExec</span> to create a set of difference images in <span class="file">diffdir</span>, we generate an image difference table using <span class="file">mFitExec</span>: sample <span class="file"><a href="examples/mBgModel/fits.tbl">fits.tbl</a></span>.</p>

<dl class="example">
  <dt>$ mBgModel images.tbl fits.tbl corrections.tbl</dt>
  <dd>[struct stat="OK"]</dd>
</dl>

<p>This results in the creation of <span class="file"><a href="examples/mBgModel/corrections.tbl">corrections.tbl</a></span>.</p>

</div>
</div>
<!--#include virtual="include/footer.html"-->
